// Kullanƒ±cƒ± bilgilerini saklayacaƒüƒ±mƒ±z deƒüi≈üken
let currentUser = null;
let allWords = [];
let currentEditingWordId = null;

// C√úMLE Dƒ∞L SE√áƒ∞Mƒ∞ DEƒûƒ∞≈ûKENLERƒ∞
let selectedSentenceLanguage = 'turkish';
let selectedSentencePoints = 5;

// Sayfa ge√ßi≈ü fonksiyonlarƒ±
function showPage(pageId) {
    document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
    });
    document.getElementById(pageId).classList.add('active');
}

// Dƒ∞L SE√áƒ∞Mƒ∞ FONKSƒ∞YONU
function initLanguageSelection() {
    const langOptions = document.querySelectorAll('.lang-option');
    
    langOptions.forEach(option => {
        option.addEventListener('click', function() {
            // Aktif sƒ±nƒ±fƒ±nƒ± kaldƒ±r
            langOptions.forEach(opt => {
                opt.classList.remove('active');
            });
            
            // Tƒ±klanana aktif sƒ±nƒ±fƒ± ekle
            this.classList.add('active');
            
            // Se√ßilen dili ve puanƒ± g√ºncelle
            selectedSentenceLanguage = this.dataset.lang;
            selectedSentencePoints = parseInt(this.dataset.points);
            
            // G√∂rsel g√ºncellemeler
            document.getElementById('sentencePoints').textContent = selectedSentencePoints;
            document.getElementById('selectedPoints').textContent = selectedSentencePoints;
            
            // Dil adƒ±nƒ± g√ºncelle
            const langNames = {
                'turkish': 'T√ºrk√ße',
                'english': 'ƒ∞ngilizce', 
                'arabic': 'Arap√ßa'
            };
            document.getElementById('selectedLangName').textContent = langNames[selectedSentenceLanguage];
        });
    });
}

// C√ºmle modal a√ßƒ±ldƒ±ƒüƒ±nda dil se√ßimini ba≈ülat
function openSentenceModal(wordId) {
    const word = allWords.find(w => w._id === wordId);
    if (word) {
        currentEditingWordId = wordId;
        document.getElementById('modalWordName').textContent = word.word;
        document.getElementById('modalWordMeaning').textContent = word.meaning;
        document.getElementById('sentenceInput').value = word.sentence || '';
        document.getElementById('sentenceMessage').innerHTML = '';
        
        // Dil se√ßimini sƒ±fƒ±rla (her a√ßƒ±lƒ±≈üta T√ºrk√ße)
        selectedSentenceLanguage = 'turkish';
        selectedSentencePoints = 5;
        
        // Aktif butonu sƒ±fƒ±rla
        document.querySelectorAll('.lang-option').forEach(opt => opt.classList.remove('active'));
        document.querySelector('.lang-option[data-lang="turkish"]').classList.add('active');
        
        // Puan bilgisini g√ºncelle
        document.getElementById('sentencePoints').textContent = '5';
        document.getElementById('selectedPoints').textContent = '5';
        document.getElementById('selectedLangName').textContent = 'T√ºrk√ße';
        
        // C√ºmle onay durumuna g√∂re mesaj g√∂ster
        if (word.sentence && word.sentenceStatus === 'pending') {
            document.getElementById('sentenceMessage').innerHTML = 
                '<div class="message warning">‚è≥ C√ºmleniz onay bekliyor</div>';
        }
        
        document.getElementById('sentenceModal').classList.add('active');
        
        // Dil se√ßimini ba≈ülat
        setTimeout(initLanguageSelection, 100);
    }
}

// ADMIN PANELƒ∞ FONKSƒ∞YONLARI - GER√áEK BACKEND BAƒûLANTILI
function showAdminPage() {
    if (currentUser && currentUser.role === 'admin') {
        showPage('adminPage');
        loadAdminData();
    } else {
        alert('‚ùå Admin yetkiniz yok!');
    }
}

function showAdminTab(tabName) {
    // Tab butonlarƒ±nƒ± g√ºncelle
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Tab i√ßeriklerini g√ºncelle
    document.querySelectorAll('.admin-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab').classList.add('active');
}

async function loadAdminData() {
    // Admin verilerini backend'den y√ºkle
    await loadPendingWords();
    await loadPendingSentences();
}

// GER√áEK: Backend'den onay bekleyen kelimeleri √ßek
async function loadPendingWords() {
    try {
        const response = await fetch('http://localhost:5000/api/admin/pending-words');
        const data = await response.json();
        
        if (data.success) {
            displayPendingWords(data.pendingWords);
        } else {
            document.getElementById('pendingWordsList').innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">‚ùå</div>
                    <h3>Veri y√ºklenemedi</h3>
                </div>
            `;
        }
    } catch (error) {
        console.error('Admin kelime y√ºkleme hatasƒ±:', error);
        document.getElementById('pendingWordsList').innerHTML = `
            <div class="empty-state">
                <div class="empty-icon">üîå</div>
                <h3>Sunucu baƒülantƒ± hatasƒ±</h3>
                <p>Backend √ßalƒ±≈üƒ±yor mu kontrol edin</p>
            </div>
        `;
    }
}

function displayPendingWords(words) {
    const pendingWordsList = document.getElementById('pendingWordsList');
    
    if (!words || words.length === 0) {
        pendingWordsList.innerHTML = `
            <div class="empty-state">
                <div class="empty-icon">‚úÖ</div>
                <h3>Onay bekleyen kelime yok</h3>
            </div>
        `;
        return;
    }
    
    pendingWordsList.innerHTML = words.map(word => `
        <div class="admin-item">
            <div class="item-info">
                <span class="lang-badge">${getLanguageFlag(word.language)} ${word.language.toUpperCase()}</span>
                <strong>${word.word}</strong> - ${word.meaning}
                <br>
                <small>Ekleyen: ${word.studentName} ‚Ä¢ ${formatTime(word.createdAt)}</small>
            </div>
            <div class="item-actions">
                <button class="btn-approve" onclick="approveWord('${word._id}')">‚úÖ Onayla</button>
                <button class="btn-reject" onclick="rejectWord('${word._id}')">‚ùå Reddet</button>
            </div>
        </div>
    `).join('');
}

// GER√áEK: Backend'den onay bekleyen c√ºmleleri √ßek
async function loadPendingSentences() {
    try {
        const response = await fetch('http://localhost:5000/api/admin/pending-words');
        const data = await response.json();
        
        if (data.success) {
            displayPendingSentences(data.pendingSentences);
        } else {
            document.getElementById('pendingSentencesList').innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">‚ùå</div>
                    <h3>Veri y√ºklenemedi</h3>
                </div>
            `;
        }
    } catch (error) {
        console.error('Admin c√ºmle y√ºkleme hatasƒ±:', error);
        document.getElementById('pendingSentencesList').innerHTML = `
            <div class="empty-state">
                <div class="empty-icon">üîå</div>
                <h3>Sunucu baƒülantƒ± hatasƒ±</h3>
            </div>
        `;
    }
}

function displayPendingSentences(sentences) {
    const pendingSentencesList = document.getElementById('pendingSentencesList');
    
    if (!sentences || sentences.length === 0) {
        pendingSentencesList.innerHTML = `
            <div class="empty-state">
                <div class="empty-icon">‚úÖ</div>
                <h3>Onay bekleyen c√ºmle yok</h3>
            </div>
        `;
        return;
    }
    
    pendingSentencesList.innerHTML = sentences.map(word => `
        <div class="admin-item">
            <div class="item-info">
                <span class="lang-badge">${getLanguageFlag(word.language)} ${word.language.toUpperCase()}</span>
                <strong>Kelime:</strong> ${word.word}
                <br>
                <strong>C√ºmle:</strong> "${word.sentence}"
                <br>
                <small>Ekleyen: ${word.studentName} ‚Ä¢ ${formatTime(word.createdAt)}</small>
            </div>
            <div class="item-actions">
                <button class="btn-approve" onclick="approveSentence('${word._id}')">‚úÖ Onayla</button>
                <button class="btn-reject" onclick="rejectSentence('${word._id}')">‚ùå Reddet</button>
            </div>
        </div>
    `).join('');
}

// GER√áEK: Backend'e kelime onaylama isteƒüi g√∂nder
async function approveWord(wordId) {
    if(!confirm('Bu kelimeyi onaylamak istediƒüinize emin misiniz?\n√ñƒürenciye +10 puan verilecek.')) return;
    
    try {
        const response = await fetch('http://localhost:5000/api/admin/word-action', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                wordId: wordId,
                action: 'approve',
                adminId: currentUser.studentId 
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            alert('‚úÖ ' + data.message);
            await loadPendingWords(); // Listeyi yenile
        } else {
            alert('‚ùå ' + data.message);
        }
    } catch (error) {
        alert('‚ùå Sunucu hatasƒ±! Backend √ßalƒ±≈üƒ±yor mu?');
    }
}

// GER√áEK: Backend'e kelime reddetme isteƒüi g√∂nder
async function rejectWord(wordId) {
    const reason = prompt('Reddetme sebebini yazƒ±n:');
    if (!reason) return;
    
    try {
        const response = await fetch('http://localhost:5000/api/admin/word-action', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                wordId: wordId,
                action: 'reject',
                adminId: currentUser.studentId 
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            alert('‚ùå ' + data.message);
            await loadPendingWords(); // Listeyi yenile
        } else {
            alert('‚ùå ' + data.message);
        }
    } catch (error) {
        alert('‚ùå Sunucu hatasƒ±!');
    }
}

// GER√áEK: Backend'e c√ºmle onaylama isteƒüi g√∂nder
async function approveSentence(wordId) {
    if(!confirm('Bu c√ºmleyi onaylamak istediƒüinize emin misiniz?')) return;
    
    try {
        const response = await fetch('http://localhost:5000/api/admin/sentence-action', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                wordId: wordId,
                action: 'approve',
                adminId: currentUser.studentId 
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            alert('‚úÖ ' + data.message);
            await loadPendingSentences(); // Listeyi yenile
        } else {
            alert('‚ùå ' + data.message);
        }
    } catch (error) {
        alert('‚ùå Sunucu hatasƒ±!');
    }
}

// GER√áEK: Backend'e c√ºmle reddetme isteƒüi g√∂nder
async function rejectSentence(wordId) {
    const reason = prompt('Reddetme sebebini yazƒ±n:');
    if (!reason) return;
    
    try {
        const response = await fetch('http://localhost:5000/api/admin/sentence-action', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                wordId: wordId,
                action: 'reject',
                adminId: currentUser.studentId 
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            alert('‚ùå ' + data.message);
            await loadPendingSentences(); // Listeyi yenile
        } else {
            alert('‚ùå ' + data.message);
        }
    } catch (error) {
        alert('‚ùå Sunucu hatasƒ±!');
    }
}

// Zaman formatlama
function formatTime(dateString) {
    const date = new Date(dateString);
    const now = new Date();
    const diffMs = now - date;
    const diffMins = Math.floor(diffMs / 60000);
    const diffHours = Math.floor(diffMs / 3600000);
    const diffDays = Math.floor(diffMs / 86400000);
    
    if (diffMins < 1) return 'az √∂nce';
    if (diffMins < 60) return `${diffMins} dakika √∂nce`;
    if (diffHours < 24) return `${diffHours} saat √∂nce`;
    if (diffDays < 7) return `${diffDays} g√ºn √∂nce`;
    
    return date.toLocaleDateString('tr-TR');
}

// Login form i≈üleyici
document.getElementById('loginForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const studentId = document.getElementById('studentId').value;
    const password = document.getElementById('password').value;
    const messageDiv = document.getElementById('message');
    
    try {
        const response = await fetch('http://localhost:5000/api/auth/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ studentId, password })
        });
        
        const data = await response.json();
        
        if (data.success) {
            currentUser = data.user;
            messageDiv.innerHTML = '<div class="message success">‚úÖ Giri≈ü ba≈üarƒ±lƒ±! Y√∂nlendiriliyorsunuz...</div>';
            
            setTimeout(() => {
                if (currentUser.isFirstLogin) {
                    showPage('changePasswordPage');
                } else {
                    showProfilePage();
                }
            }, 1500);
            
        } else {
            messageDiv.innerHTML = '<div class="message error">‚ùå ' + data.message + '</div>';
        }
    } catch (error) {
        messageDiv.innerHTML = '<div class="message error">‚ùå Sunucu baƒülantƒ± hatasƒ±!</div>';
    }
});

// ≈ûifre deƒüi≈ütirme form i≈üleyici
document.getElementById('changePasswordForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const newPassword = document.getElementById('newPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    const messageDiv = document.getElementById('passwordMessage');
    
    if (newPassword !== confirmPassword) {
        messageDiv.innerHTML = '<div class="message error">‚ùå ≈ûifreler e≈üle≈ümiyor!</div>';
        return;
    }
    
    if (newPassword.length < 6) {
        messageDiv.innerHTML = '<div class="message error">‚ùå ≈ûifre en az 6 karakter olmalƒ±!</div>';
        return;
    }
    
    try {
        const response = await fetch('http://localhost:5000/api/auth/change-password', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                studentId: currentUser.studentId, 
                newPassword: newPassword 
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            messageDiv.innerHTML = '<div class="message success">‚úÖ ≈ûifre ba≈üarƒ±yla deƒüi≈ütirildi!</div>';
            
            setTimeout(() => {
                showProfilePage();
            }, 2000);
            
        } else {
            messageDiv.innerHTML = '<div class="message error">‚ùå ' + data.message + '</div>';
        }
    } catch (error) {
        messageDiv.innerHTML = '<div class="message error">‚ùå ≈ûifre deƒüi≈ütirme hatasƒ±!</div>';
    }
});

// Kelime ekleme form i≈üleyici
document.getElementById('wordAddForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const word = document.getElementById('wordInput').value;
    const meaning = document.getElementById('wordMeaning').value;
    const messageDiv = document.getElementById('wordMessage');
    const language = document.getElementById('wordAddTitle').textContent.includes('T√ºrk√ße') ? 'turkish' : 
                    document.getElementById('wordAddTitle').textContent.includes('ƒ∞ngilizce') ? 'english' : 'arabic';
    
    try {
        const response = await fetch('http://localhost:5000/api/words/add', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                word, 
                meaning, 
                language, 
                studentId: currentUser.studentId 
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            messageDiv.innerHTML = '<div class="message success">‚úÖ ' + data.message + '</div>';
            
            // Formu temizle
            document.getElementById('wordAddForm').reset();
            
            // 2 saniye sonra profil sayfasƒ±na d√∂n
            setTimeout(() => {
                showProfilePage();
            }, 2000);
        } else {
            messageDiv.innerHTML = '<div class="message error">‚ùå ' + data.message + '</div>';
        }
    } catch (error) {
        messageDiv.innerHTML = '<div class="message error">‚ùå Kelime ekleme hatasƒ±!</div>';
    }
});

// C√úMLE EKLEME FORM ƒ∞≈ûLEYƒ∞Cƒ∞Sƒ∞ - G√úNCELLENDƒ∞
document.getElementById('sentenceForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const sentence = document.getElementById('sentenceInput').value;
    const messageDiv = document.getElementById('sentenceMessage');
    
    try {
        const response = await fetch('http://localhost:5000/api/words/add-sentence', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                wordId: currentEditingWordId, 
                sentence, 
                studentId: currentUser.studentId,
                sentenceLanguage: selectedSentenceLanguage // YENƒ∞: Dƒ∞L Bƒ∞LGƒ∞Sƒ∞ EKLENDƒ∞
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            messageDiv.innerHTML = '<div class="message success">‚úÖ ' + data.message + '</div>';
            
            // Kelime listesini g√ºncelle
            await loadAllWords();
            
            // 2 saniye sonra modal'ƒ± kapat
            setTimeout(() => {
                closeSentenceModal();
            }, 2000);
        } else {
            messageDiv.innerHTML = '<div class="message error">‚ùå ' + data.message + '</div>';
        }
    } catch (error) {
        messageDiv.innerHTML = '<div class="message error">‚ùå C√ºmle ekleme hatasƒ±!</div>';
    }
});

// Profil sayfasƒ±nƒ± g√∂ster
function showProfilePage() {
    if (currentUser) {
        document.getElementById('profileName').textContent = currentUser.name;
        document.getElementById('profileClass').textContent = currentUser.class;
        document.getElementById('profileStudentId').textContent = currentUser.studentId;
        document.getElementById('profilePoints').textContent = currentUser.points;
        
        // Admin ise admin butonunu g√∂ster
        const adminBtn = document.getElementById('adminBtn');
        if (adminBtn) {
            adminBtn.style.display = currentUser.role === 'admin' ? 'block' : 'none';
        }
        
        showPage('profilePage');
    }
}

// Kelime ekleme sayfasƒ±nƒ± g√∂ster
function showWordAddPage(language) {
    const titles = {
        'turkish': 'üáπüá∑ T√ºrk√ße Kelime Ekle',
        'english': 'üá∫üá∏ ƒ∞ngilizce Kelime Ekle', 
        'arabic': 'üá∏üá¶ Arap√ßa Kelime Ekle'
    };
    
    document.getElementById('wordAddTitle').textContent = titles[language];
    document.getElementById('wordMessage').innerHTML = '';
    document.getElementById('wordAddForm').reset();
    showPage('wordAddPage');
}

// T√úM KELƒ∞MELER sayfasƒ±nƒ± g√∂ster
async function showAllWordsPage() {
    if (currentUser) {
        document.getElementById('allWordsPoints').textContent = currentUser.points;
        showPage('allWordsPage');
        await loadAllWords();
    }
}

// T√ºm kelimeleri y√ºkle
async function loadAllWords() {
    try {
        const response = await fetch('http://localhost:5000/api/words/all');
        const data = await response.json();
        
        if (data.success) {
            allWords = data.words;
            renderWords();
        }
    } catch (error) {
        console.error('Kelimeleri y√ºkleme hatasƒ±:', error);
    }
}

// Kelimeleri ekrana render et
function renderWords() {
    const wordsGrid = document.getElementById('wordsGrid');
    const wordsCount = document.getElementById('wordsCount');
    
    wordsCount.textContent = allWords.length;
    
    if (allWords.length === 0) {
        wordsGrid.innerHTML = `
            <div class="empty-state">
                <div class="empty-icon">üìö</div>
                <h3>Hen√ºz kelime eklenmemi≈ü</h3>
                <p>ƒ∞lk kelimeyi eklemek i√ßin yukarƒ±daki butonlarƒ± kullanƒ±n</p>
            </div>
        `;
        return;
    }
    
    wordsGrid.innerHTML = allWords.map(word => {
        // Kullanƒ±cƒ±nƒ±n bu kelimeye oy verip vermediƒüini kontrol et
        const userVote = word.votedUsers ? word.votedUsers.find(vote => vote.studentId === currentUser.studentId) : null;
        const hasUserVoted = !!userVote;
        const userVoteType = userVote ? userVote.voteType : null;
        
        // C√ºmle durumunu kontrol et
        const canAddSentence = !word.sentence || word.sentenceStatus === 'pending';
        const hasApprovedSentence = word.sentence && word.sentenceStatus === 'approved';
        
        return `
        <div class="word-card">
            <div class="word-header">
                <div class="word-title">${word.word}</div>
                <div class="word-language">${getLanguageFlag(word.language)}</div>
            </div>
            
            <div class="word-meaning-preview">${word.meaning}</div>
            
            ${hasApprovedSentence ? `
                <div class="sentence-preview">
                    <strong>üí¨ C√ºmle:</strong> ${word.sentence}
                </div>
            ` : word.sentence && word.sentenceStatus === 'pending' ? `
                <div class="sentence-preview pending">
                    <strong>‚è≥ C√ºmle:</strong> ${word.sentence} <em>(Onay bekliyor)</em>
                </div>
            ` : ''}
            
            <div class="word-stats">
                <div class="word-stat ${userVoteType === 'like' ? 'user-vote' : ''}">
                    <span class="stat-icon">üëç</span> ${word.likes || 0}
                </div>
                <div class="word-stat ${userVoteType === 'dislike' ? 'user-vote' : ''}">
                    <span class="stat-icon">üëé</span> ${word.dislikes || 0}
                </div>
                <div class="word-stat">
                    <span class="stat-icon">üë§</span> ${word.studentName}
                </div>
            </div>
            
            <div class="word-actions">
                <button class="btn-vote like-btn ${userVoteType === 'like' ? 'active' : ''}" 
                        onclick="voteWord('${word._id}', 'like')"
                        ${hasUserVoted && userVoteType === 'like' ? 'disabled' : ''}>
                    üëç Beƒüen
                </button>
                <button class="btn-vote dislike-btn ${userVoteType === 'dislike' ? 'active' : ''}" 
                        onclick="voteWord('${word._id}', 'dislike')"
                        ${hasUserVoted && userVoteType === 'dislike' ? 'disabled' : ''}>
                    üëé Beƒüenme
                </button>
                <button class="btn-secondary" 
                        onclick="openSentenceModal('${word._id}')"
                        ${!canAddSentence ? 'disabled' : ''}>
                    üí¨ C√ºmle Ekle
                </button>
            </div>
        </div>
        `;
    }).join('');
}

// Kelime arama
async function searchWords() {
    const searchTerm = document.getElementById('searchWordsInput').value;
    
    try {
        const response = await fetch(`http://localhost:5000/api/words/search?q=${encodeURIComponent(searchTerm)}`);
        const data = await response.json();
        
        if (data.success) {
            allWords = data.words;
            renderWords();
        }
    } catch (error) {
        console.error('Arama hatasƒ±:', error);
    }
}

// Like/Dislike i≈ülemi
async function voteWord(wordId, type) {
    try {
        const response = await fetch('http://localhost:5000/api/words/vote', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                wordId, 
                type, 
                studentId: currentUser.studentId 
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            if (data.newPoints) {
                currentUser.points = data.newPoints;
                updatePointsDisplay();
            }
            
            // Kelime listesini g√ºncelle
            await loadAllWords();
            
            // Ba≈üarƒ± mesajƒ±
            showTempMessage(data.message, 'success');
        } else {
            showTempMessage(data.message, 'error');
        }
    } catch (error) {
        console.error('Oy verme hatasƒ±:', error);
        showTempMessage('Oy verme hatasƒ±!', 'error');
    }
}

// C√ºmle ekleme modal'ƒ±nƒ± kapat
function closeSentenceModal() {
    document.getElementById('sentenceModal').classList.remove('active');
    currentEditingWordId = null;
}

// Dil bayraƒüƒ± getir
function getLanguageFlag(language) {
    const flags = {
        'turkish': 'üáπüá∑',
        'english': 'üá∫üá∏',
        'arabic': 'üá∏üá¶'
    };
    return flags[language] || 'üåê';
}

// Puan display'ini g√ºncelle
function updatePointsDisplay() {
    document.getElementById('profilePoints').textContent = currentUser.points;
    document.getElementById('allWordsPoints').textContent = currentUser.points;
}

// Ge√ßici mesaj g√∂ster
function showTempMessage(message, type) {
    const tempDiv = document.createElement('div');
    tempDiv.className = `message ${type}`;
    tempDiv.textContent = message;
    tempDiv.style.position = 'fixed';
    tempDiv.style.top = '20px';
    tempDiv.style.left = '50%';
    tempDiv.style.transform = 'translateX(-50%)';
    tempDiv.style.zIndex = '1000';
    
    document.body.appendChild(tempDiv);
    
    setTimeout(() => {
        document.body.removeChild(tempDiv);
    }, 3000);
}

// √áƒ±kƒ±≈ü yap
function logout() {
    currentUser = null;
    allWords = [];
    currentEditingWordId = null;
    
    document.getElementById('loginForm').reset();
    document.getElementById('changePasswordForm').reset();
    document.getElementById('wordAddForm').reset();
    document.getElementById('sentenceForm').reset();
    
    document.getElementById('message').innerHTML = '';
    document.getElementById('passwordMessage').innerHTML = '';
    document.getElementById('wordMessage').innerHTML = '';
    document.getElementById('sentenceMessage').innerHTML = '';
    
    showPage('loginPage');
}

// Sayfa y√ºklendiƒüinde login ekranƒ±nƒ± g√∂ster
document.addEventListener('DOMContentLoaded', function() {
    showPage('loginPage');
});